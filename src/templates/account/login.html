{% extends "account/base_entrance.html" %}
{% load allauth account %}

{% block head_title %}
  Login
{% endblock head_title %}

{% block content_title %}
  Sign in to your account
{% endblock content_title %}

{% block content %}
  {% if not SOCIALACCOUNT_ONLY %}

    {% url 'account_login' as login_url %}
    {% element form form=form method="post" action=login_url tags="entrance,login" %}
      {% slot body %}
        {% csrf_token %}
        {% element fields form=form unlabeled=True %}
        {% endelement %}
        {{ redirect_field }}
      {% endslot %}

      {% slot actions %}
        {% element button type="submit" tags="prominent,login" icon='<path d="M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4"></path><polyline points="10 17 15 12 10 7"></polyline><line x1="15" x2="3" y1="12" y2="12"></line>' %}
          Sign In
        {% endelement %}
      {% endslot %}
    {% endelement %}
  {% endif %}

  {% if LOGIN_BY_CODE_ENABLED or PASSKEY_LOGIN_ENABLED %}
    {% element hr %}
    {% endelement %}
    {% element button_group vertical=True %}
      {% if PASSKEY_LOGIN_ENABLED %}
        {% element button type="submit" form="mfa_login" id="passkey_login" tags="prominent,login,outline,primary" %}
          Sign in with a passkey
        {% endelement %}
      {% endif %}
      {% if LOGIN_BY_CODE_ENABLED %}
        {% element button href=request_login_code_url tags="prominent,login,outline,primary" %}
          Send me a sign-in code
        {% endelement %}
      {% endif %}
    {% endelement %}
  {% endif %}

  {% if SOCIALACCOUNT_ENABLED %}
    {% include "socialaccount/snippets/login.html" with page_layout="entrance" %}
  {% endif %}

  {% if not SOCIALACCOUNT_ONLY and REGISTRATION %}
    <div class="mt-6 text-center">
      <p class="text-gray-400">
        Need an account?
        <a class="text-indigo-400 hover:text-indigo-300"
           href="{% url 'account_signup' %}">Register now</a>
      </p>
    </div>
  {% endif %}
{% endblock content %}

{% block extra_body %}
  {{ block.super }}
  {% if PASSKEY_LOGIN_ENABLED %}
    {% include "mfa/webauthn/snippets/login_script.html" with button_id="passkey_login" %}
  {% endif %}
{% endblock extra_body %}
